{% load staticfiles %}

<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link href="//maxcdn.bootstrapcdn.com/bootstrap/latest/css/bootstrap.min.css" rel="stylesheet">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/latest/js/bootstrap.min.js"></script>
<style type="text/css">
* { font-family: NanumGothic, 'Malgun Gothic'; }
body { padding-top: 50px; }
.starter-template {
  padding: 40px 15px;
  text-align: center;
}
</style>

<title>Le Pomier Bokhyun, Baker Choi :)</title>

</head>
<body>
 
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">토글 네비게이션</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">Le Pomier Bokhyun, Bake Timer :)</a>
    </div>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li class="active"><a href="#">홈</a></li>
        <li><a href="#about">소개</a></li>
        <li><a href="#contact">연락</a></li>
      </ul>
    </div>
  </div>
</div>
<div class="container">
  <div class="starter-template">
    <h1>르 뽀미에 베이커리,<br>복현롯데슈퍼점</h1>
    <p class="lead">맛있는 빵을 준비합니다.<br>여러분을 위해서요.</p>
  </div>






  <div class="container">
    {% for bread in breads %}
    <div class="starter-template">
      <h1><a href = "">{{ bread.name }}</a></h1>
      <p><img src='uploads/{{ bread.image_file }}' style="max-width: 100%; height: auto;"></p>
      <p class="lead">{{ bread.description }}</p>


      <!--
      <script src="{% static 'js/timer.js' %}"></script>
      -->

      <script language="javascript">

        $(document).ready(function(){
            //초기값
            var epoch = {{ nowTime|date:"U" }}//new Date().getTime() / 1000;
            epoch = Math.floor(epoch);

            var release = {{ bread.release_at|date:"U" }};
                            
            var timeleft = release - epoch; 

            var timeover = false;

            if(timeleft < 0)
            {
                timeover = true;
                timeleft = epoch - release;
            }

            var hour = Math.floor(timeleft / 3600);
            var minute = Math.floor((timeleft % 3600) / 60);
            var second = Math.floor(timeleft % 60)
            // 초기화
            $(".countTimeHour{{ bread.id }}").html(hour);
            $(".countTimeMinute{{ bread.id }}").html(minute);
            $(".countTimeSecond{{ bread.id }}").html(second);
            
            var timer = setInterval(function () {
                    // 설정
                    $(".countTimeHour{{ bread.id }}").html(hour);
                    $(".countTimeMinute{{ bread.id }}").html(minute);
                    $(".countTimeSecond{{ bread.id }}").html(second);
                    $(".getTimeover{{ bread.id }}").html(timeover);
                    
                    if(timeover){                        
                        second++;

                        
                        // 분처리
                        if(second > 59){
                            minute++;
                            second = 0;
                        }
                        
                        //시간처리
                        if(minute > 59){
                            
                            hour++;
                            minute = 0;
                        }
                    }else{
                        if(timeleft <= 0)
                        {
                          location.reload(true);
                          timeover = true;
                        }
                        second--;
                        timeleft--;
                        
                        // 분처리
                        if(second < 0){
                            minute--;
                            second = 59;
                        }
                        
                        //시간처리
                        if(minute < 0){
                            if(hour > 0){
                                hour--;
                                minute = 59;
                            }
                            
                        }
                    }
                }, 1000); /* millisecond 단위의 인터벌 */
        });
      </script>








      {% if bread.release_at|date:"U" < nowTime|date:"U" %}
      <div>
        <strong>빵이 나왔습니다! </strong>        
      </div>

      {% else %}

      <div>
        <strong>빵 나오기 </strong>
        <span class="countTimeHour{{ bread.id }}">60</span>시간
        <span class="countTimeMinute{{ bread.id }}">60</span>분
        <span class="countTimeSecond{{ bread.id }}">60</span>초
        <strong> 전! </strong>
      </div>
      {% endif %}

    </div>
    {% endfor %}
  </div>








</div>
 
</body>
</html>